# 커넥션 관리

## TCP 커넥션

HTTP 통신은 TCP/IP 연결을 통해 이루어진다. TCP 특성에 따라 일단 연결이 되면, 클라이언트와 서버 컴퓨터 간에 주고받는 메시지들은 손실되거나 순서가 바뀌지 않고 안전하게 전달된다는 특징이 있다.

1. TCP 스트림은 세그먼트로 나뉘어 IP 패킷을 통해 전송된다

<img width="710" alt="image" src="https://github.com/flataex/http-the-definitive-guide-study/assets/67260437/6dd630e3-8b5c-4a82-9b48-4e878dbd4a9d">    
HTTP는 TCP 커넥션을 통해 전송하고자 하는 데이터를 순서에 맞게 보내고, TCP는 데이터를 세그먼트 단위로 나눠 IP 패킷을 담아 데이터를 전송한다.  
  
> IP 패킷 구성은 다음과 같다.
* IP 헤더  
발신지, 목적지 IP 주소 등  
* TCP 세그먼트 헤더  
TCP 포트 번호, TCP 제어 플래그, 데이터의 순서와 무결성을 검사하기 위해 사용되는 숫자 값  
* TCP데이터조각

2.  TCP 커넥션 유지하기
    > TCP 커넥션 구성
        <발신지 ip 주소, 발신지 포트, 수신지 ip 주소, 수신지 포트>

위 네가지 값으로 유일한 커넥션을 유지한다.

3. TCP 소켓 프로그래밍  
   **socket api 인터페이스**

<br />

## TCP의 성능에 대한 고려

HTTP는 TCP 바로 위에 있는 계층이기 때문에 HTTP 트랜잭션의 성능은 그 아래 계층인 TCP 성능에 영향을 받는다.

1. HTTP 트랜잭션 지연
   HTTP 트랜잭션을 지연시키는 원인은 여러 가지가 있다.

- DNS 이름 분석을 사용해 URI에 있는 호스트 명을 IP 주소로 변환하는 데 시간이 걸린다.
- 클라이언트는 TCP 커넥션 요청을 서버에게 보내고 서버가 커넥션 허가 응답을 회신하기를 기다린다.
- TCP 커넥션이 연결되면 클라이언트는 TCP 파이프를 통해 HTTP 요청을 보내고, 서버는 데이터가 도착하는 대로 TCP 커넥션에서 요청 메시지를 읽고 처리한다.
  <br />

## HTTP 커넥션관리
